<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>高中數學練習系統（高一）</title>
<style>
    body {
        font-family: "Microsoft JhengHei", sans-serif;
        background: #0f172a;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 30px;
    }
    h1 { margin-bottom: 10px; }
    #card {
        background: #1e293b;
        padding: 25px;
        border-radius: 12px;
        width: 480px;
        box-shadow: 0 0 20px rgba(0,0,0,0.4);
    }
    button {
        padding: 10px 16px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        margin-top: 10px;
        background: #3b82f6;
        color: white;
        font-weight: bold;
    }
    #answerInput {
        width: 100%;
        padding: 10px;
        margin-top: 12px;
        border-radius: 6px;
        border: none;
        font-size: 16px;
    }
    #result {
        font-size: 18px;
        margin-top: 12px;
        height: 30px;
    }
</style>
</head>

<body>

<h1>高一數學自動出題系統</h1>
<div id="card">
    <h2 id="topic">題目類別</h2>
    <div id="questionText">按「下一題」開始</div>

    <input id="answerInput" type="text" placeholder="輸入答案後按 Enter">
    <button id="nextBtn">下一題</button>

    <div id="result"></div>
</div>

<script>
/* ==============================
   題庫（依你給的四大主題）
   ============================== */

function randomInt(a, b) { return Math.floor(Math.random()*(b-a+1))+a; }
let usedQuestions = new Set();

function generateQuestion() {
    const types = [1,2,3,4]; 
    let type = types[randomInt(0, types.length-1)];
    let q = {}, a;

    /* ========= 1. 數與數線 ========= */
    if (type === 1) {
        const mode = randomInt(1,3);

        if (mode === 1) { // 絕對值
            let x = randomInt(-20,20);
            q.text = `計算 |${x}|`;
            a = Math.abs(x);
            q.topic = "數與數線：絕對值";
        }
        else if (mode === 2) { // 數線距離
            let a1 = randomInt(-15,15);
            let b1 = randomInt(-15,15);
            q.text = `在數線上，點 ${a1} 與 ${b1} 的距離為？`;
            a = Math.abs(a1 - b1);
            q.topic = "數與數線：距離";
        }
        else { // 四則
            let x = randomInt(-20,20);
            let y = randomInt(-20,20);
            let ops = [" + "," - "," × "," ÷ "];
            let op = ops[randomInt(0,3)];
            q.text = `計算：${x}${op}${y}`;
            if (op === " + ") a = x+y;
            if (op === " - ") a = x-y;
            if (op === " × ") a = x*y;
            if (op === " ÷ ") a = (y===0? "無解": (x/y));
            q.topic = "數與數線：四則運算";
        }
    }

    /* ========= 2. 指數/對數 ========= */
    if (type === 2) {
        const mode = randomInt(1,2);

        if (mode === 1) { // 指數運算
            let a1 = randomInt(2,5);
            let b1 = randomInt(2,4);
            let c1 = randomInt(2,4);
            q.text = `計算：${a1}^${b1} × ${a1}^${c1}`;
            a = a1 ** (b1 + c1);
            q.topic = "指數：運算";
        }
        else { // 對數（簡單）
            let base = [2, 3, 5, 10][randomInt(0,3)];
            let exp = randomInt(1,4);
            q.text = `計算：log_${base}(${base**exp})`;
            a = exp;
            q.topic = "對數：基本性質";
        }
    }

    /* ========= 3. 多項式函數 ========= */
    if (type === 3) {
        const mode = randomInt(1,3);

        if (mode === 1) { // 因式分解 ax^2 + bx
            let a1 = randomInt(1,5);
            let b1 = randomInt(1,8);
            q.text = `因式分解：${a1}x² + ${b1}x`;
            a = `${xCommon(a1,b1)}x(${a1/xCommon(a1,b1)}x + ${b1/xCommon(a1,b1)})`;
            q.topic = "多項式：因式分解";
        }
        else if (mode === 2) { // 函數值
            let m = randomInt(-5,5);
            let b = randomInt(-5,5);
            let x = randomInt(-4,4);
            q.text = `已知 f(x) = ${m}x + ${b}，求 f(${x})`;
            a = m*x + b;
            q.topic = "函數：一次函數值";
        }
        else { // 不等式
            let a1 = randomInt(1,5);
            let b1 = randomInt(-5,5);
            q.text = `解不等式：${a1}x + ${b1} > 0`;
            a = `x > ${(-b1)/a1}`;
            q.topic = "多項式：一次不等式";
        }
    }

    /* ========= 4. 直線與圓 ========= */
    if (type === 4) {
        const mode = randomInt(1,3);

        if (mode === 1) { // 斜率
            let x1 = randomInt(-5,5);
            let y1 = randomInt(-5,5);
            let x2 = randomInt(-5,5);
            let y2 = randomInt(-5,5);
            q.text = `求通過 (${x1},${y1}) 和 (${x2},${y2}) 的直線斜率`;
            a = (x2===x1? "無斜率": ( (y2-y1)/(x2-x1) ));
            q.topic = "直線：斜率";
        }
        else if (mode === 2) { // 判斷是否在直線上
            let m = randomInt(-4,4);
            let b = randomInt(-4,4);
            let x = randomInt(-4,4);
            let y = m*x + b;
            q.text = `判斷點 (${x},${y}) 是否在 y=${m}x+${b} 上（回答：是 或 否）`;
            a = "是";
            q.topic = "直線：點在線上";
        }
        else { // 圓
            let h = randomInt(-4,4), k = randomInt(-4,4), r = randomInt(2,6);
            let x = randomInt(-4,4), y = randomInt(-4,4);
            q.text = `已知圓心 (${h},${k})、半徑 ${r}，判斷點 (${x},${y}) 是否在圓內（回答：是 或 否）`;
            let dist = Math.sqrt((x-h)**2 + (y-k)**2);
            a = dist <= r ? "是" : "否";
            q.topic = "圓：點是否在圓內";
        }
    }

    // 把正確答案存起來
    currentAnswer = a;
    return q;
}

function xCommon(a,b){
    for(let i=Math.min(a,b);i>=1;i--){
        if(a%i===0 && b%i===0) return i;
    }
    return 1;
}

/* ==============================
   主功能：出題、批改、Enter
   ============================== */

let currentAnswer = null;

function newQuestion() {
    let q = generateQuestion();
    document.getElementById("topic").textContent = q.topic;
    document.getElementById("questionText").textContent = q.text;
    document.getElementById("result").textContent = "";
    document.getElementById("answerInput").value = "";
    document.getElementById("answerInput").focus();
}

document.getElementById("nextBtn").onclick = newQuestion;

document.getElementById("answerInput").addEventListener("keydown", function(e){
    if(e.key === "Enter"){
        checkAnswer();
        setTimeout(newQuestion, 600);
    }
});

function checkAnswer(){
    let user = document.getElementById("answerInput").value.trim();

    if(user === currentAnswer.toString()){
        document.getElementById("result").textContent = "✔ 正確！";
        document.getElementById("result").style.color = "#4ade80";
    } else {
        document.getElementById("result").textContent = "✘ 錯誤，正確答案是：" + currentAnswer;
        document.getElementById("result").style.color = "#f87171";
    }
}

</script>

</body>
</html>
