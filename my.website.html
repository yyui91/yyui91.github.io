<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>數學隨機出題系統</title>
<style>
body{font-family:sans-serif;background:#eef2f7;font-size:22px}
.box{max-width:1100px;margin:30px auto;background:#fff;padding:30px;border-radius:16px}
h1{font-size:34px}
select,button,input{font-size:22px;padding:10px 14px;margin-top:10px}
.q{margin-top:25px;font-size:26px;line-height:1.7}
.result{margin-top:12px;font-weight:bold}
.choice label{display:block;margin:6px 0}
</style>
</head>
<body>

<div class="box">
<h1>數學隨機出題系統</h1>

<select id="chapter">
<option value="exp">① 指數與根式</option>
<option value="log">② 對數</option>
<option value="poly">③ 多項式與函數</option>
<option value="ineq">④ 不等式</option>
<option value="word">⑤ 文字題</option>
<option value="geo">⑥ 幾何</option>
</select>
<br>
<button onclick="newQ()">開始出題</button>

<div class="q" id="q"></div>

<div id="inputArea">
<input id="ans" placeholder="輸入答案後按 Enter">
</div>

<div class="result" id="res"></div>
</div>

<script>
let checkAnswerFn=null;

function r(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function eq(a,b){return Math.abs(a-b)<1e-6;}

function parseNum(s){
  if(s.includes("/")){
    let [a,b]=s.split("/").map(Number);
    if(!isNaN(a)&&!isNaN(b)) return a/b;
  }
  return Number(s);
}

/* ===== 指數與根式 ===== */
function expQ(){
  let a=r(2,5), b=r(2,4), c=r(1,3);
  let val=Math.pow(a,b-c);
  checkAnswerFn=u=>eq(u,val);
  return `化簡並求值： \\( \\frac{${a}^{${b}}}{${a}^{${c}}} \\)`;
}

/* ===== 對數 ===== */
function logQ(){
  let x=r(2,8);
  let v=Math.log10(x);
  checkAnswerFn=u=>eq(u,x);
  return `解對數方程： log(x) = ${v.toFixed(4)}`;
}

/* ===== 多項式 / 函數 ===== */
function polyQ(){
  let r1=r(-5,5), r2=r(-5,5);
  checkAnswerFn=u=>eq(u,r1)||eq(u,r2);
  return `已知二次函數的零點為 ${r1} 與 ${r2}，請輸入其中一個零點`;
}

/* ===== 不等式 ===== */
function ineqQ(){
  let a=r(1,4), b=r(3,9);
  let v=b/a;
  checkAnswerFn=u=>eq(u,v);
  return `解不等式 |${a}x| ≥ ${b}，請輸入正的臨界值`;
}

/* ===== 文字題 ===== */
function wordQ(){
  let a=r(2,9), b=r(3,6);
  let val=a*Math.pow(10,b);
  checkAnswerFn=u=>eq(u,val);
  return `某數為 ${a}×10<sup>${b}</sup>，請輸入其實際數值`;
}

/* ===== 幾何 ===== */
function geoQ(){
  let h=r(-5,5), k=r(-5,5), r0=r(2,8);
  checkAnswerFn=u=>eq(u,r0);
  return `圓方程 (x-${h})²+(y-${k})²=${r0*r0}，求半徑`;
}

/* ===== 出題 ===== */
function newQ(){
  res.textContent="";
  ans.value="";
  let c=chapter.value;
  if(c==="exp") q.innerHTML=expQ();
  if(c==="log") q.innerHTML=logQ();
  if(c==="poly") q.innerHTML=polyQ();
  if(c==="ineq") q.innerHTML=ineqQ();
  if(c==="word") q.innerHTML=wordQ();
  if(c==="geo") q.innerHTML=geoQ();
  ans.focus();
}

/* ===== Enter 批改 + 下一題 ===== */
ans.addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    let u=parseNum(ans.value.trim());
    if(isNaN(u)) return;
    res.textContent = checkAnswerFn(u) ? "✔ 正確" : "✘ 錯誤";
    setTimeout(newQ,600);
  }
});
</script>

</body>
</html>
